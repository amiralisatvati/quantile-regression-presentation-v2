<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>رگرسیون کوانتایل - دانشگاه فردوسی مشهد</title>
	  <!-- KaTeX for mathematical formulas -->
	  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
	  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
	  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
	  <!-- SEO & Social Media -->
	  <meta name="description" content="ارائه حرفه‌ای رگرسیون کوانتایل - دانشگاه فردوسی مشهد">
	  <meta name="author" content="امیرعلی سطوتی">
	  <meta property="og:title" content="رگرسیون کوانتایل - Quantile Regression">
	  <meta property="og:description" content="ارائه تعاملی رگرسیون کوانتایل با ۴۰ اسلاید">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #3b82f6;
            --secondary: #8b5cf6;
            --accent: #ec4899;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #0f172a;
            --light: #f8fafc;
            --text-dark: #1e293b;
            --text-light: #f1f5f9;
            --card-bg: rgba(255, 255, 255, 0.1);
            --card-border: rgba(255, 255, 255, 0.2);
        }

        body {
            font-family: 'Vazirmatn', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: var(--text-light);
            overflow: hidden;
            min-height: 100vh;
        }

        #particleCanvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1;
            opacity: 0.3;
        }

        #drawingCanvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 30;
            cursor: crosshair;
            display: none;
        }

        #laserPointer {
            position: fixed;
            width: 15px;
            height: 15px;
            border: 2px solid #ef4444;
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(239, 68, 68, 0.8);
            z-index: 999;
            pointer-events: none;
            display: none;
        }

        .container {
            position: relative;
            z-index: 10;
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--card-border);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 20;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .breadcrumb {
            font-size: 0.85rem;
            color: var(--text-light);
            opacity: 0.7;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            order: 3;
            width: 100%;
            padding-top: 0.5rem;
            border-top: 1px solid var(--card-border);
            margin-top: 0.5rem;
        }

        .breadcrumb span {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-section h1 {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .university-badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .controls {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'Vazirmatn', sans-serif;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);
        }

        .btn-secondary {
            background: var(--card-bg);
            color: var(--text-light);
            border: 1px solid var(--card-border);
            padding: 0.5rem 0.8rem;
            font-size: 0.8rem;
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .btn-secondary.active {
            background: var(--primary);
            border-color: var(--primary);
        }

        .timer-display {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-weight: 600;
            min-width: 60px;
            text-align: center;
        }

        .slide-container {
            flex: 1;
            overflow: hidden;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slide {
            position: absolute;
            width: 100%;
            height: 100%;
            padding: 3rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.6s ease;
            transform: scale(0.95);
            pointer-events: none;
        }

        .slide.active {
            opacity: 1;
            transform: scale(1);
            pointer-events: auto;
            z-index: 15;
        }

        .slide.prev {
            opacity: 0;
            transform: scale(0.9);
        }

        .slide-content {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 3rem;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            animation: slideIn 0.6s ease;
            max-height: 90vh;
            overflow-y: auto;
        }

        .slide-content::-webkit-scrollbar {
            width: 8px;
        }

        .slide-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        .slide-content::-webkit-scrollbar-thumb {
            background: rgba(59, 130, 246, 0.5);
            border-radius: 4px;
        }

        .speaker-notes {
            position: absolute;
            bottom: 0;
            right: 0;
            left: 0;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            border-top: 2px solid var(--primary);
            padding: 1.5rem;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            z-index: 25;
            font-size: 0.9rem;
        }

        .speaker-notes.active {
            max-height: 200px;
            overflow-y: auto;
        }

        .speaker-notes-title {
            color: var(--primary);
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .notes-content {
            color: var(--text-light);
            opacity: 0.9;
            line-height: 1.6;
        }

        .notes-timing {
            font-size: 0.8rem;
            color: var(--warning);
            margin-top: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .notes-tips {
            font-size: 0.8rem;
            color: var(--success);
            margin-top: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .slide-title {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            min-height: 80vh;
        }

        .slide-title h1 {
            font-size: 3.5rem;
            margin: 2rem 0;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
        }

        .slide-title h2 {
            font-size: 1.8rem;
            color: var(--text-light);
            margin: 1rem 0;
            font-weight: 500;
        }

        .presenter-info {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
            margin-top: 3rem;
            width: 100%;
        }

        .info-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--card-border);
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
        }

        .info-card .label {
            font-size: 0.9rem;
            color: var(--text-light);
            opacity: 0.7;
            margin-bottom: 0.5rem;
        }

        .info-card .value {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-light);
        }

        .slide-content h2 {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .slide-content h3 {
            font-size: 1.5rem;
            margin: 1.5rem 0 1rem 0;
            color: var(--text-light);
        }

        .slide-content p {
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 1rem;
            color: rgba(241, 245, 249, 0.9);
        }

        .slide-content ul, .slide-content ol {
            margin: 1.5rem 0;
            padding-right: 2rem;
        }

        .slide-content li {
            margin: 0.8rem 0;
            font-size: 1.05rem;
            line-height: 1.6;
        }

        .formula-box {
            background: rgba(59, 130, 246, 0.1);
            border-left: 4px solid var(--primary);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 1.05rem;
            overflow-x: auto;
        }

        .formula-box code {
            color: #60a5fa;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 1.5rem 0;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            margin: 1.5rem 0;
        }

        .grid-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--card-border);
            padding: 1.5rem;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .grid-card:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(59, 130, 246, 0.2);
        }

        .grid-card h3 {
            margin-top: 0;
            color: var(--primary);
        }

        .chart-container {
            display: flex;
            justify-content: center;
            margin: 2rem 0;
            background: rgba(255, 255, 255, 0.03);
            padding: 2rem;
            border-radius: 12px;
            border: 1px solid var(--card-border);
        }

        footer {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            border-top: 1px solid var(--card-border);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 20;
            font-size: 0.95rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .slide-counter {
            font-weight: 600;
            color: var(--primary);
        }

        .progress-bar {
            width: 300px;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            transition: width 0.3s ease;
        }

        .nav-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 0.5rem 1rem;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            color: var(--text-light);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: var(--primary);
        }

        .code-block {
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid var(--card-border);
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1.5rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .code-block code {
            color: #60a5fa;
        }

        .shortcut-hint {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid var(--primary);
            padding: 1rem;
            border-radius: 8px;
            font-size: 0.8rem;
            color: var(--text-light);
            z-index: 100;
            max-width: 250px;
        }

        .shortcut-hint strong {
            color: var(--primary);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95rem;
            margin: 1.5rem 0;
        }

        table thead {
            background: rgba(59, 130, 246, 0.2);
            border-bottom: 2px solid var(--primary);
        }

        table tbody tr {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        table td, table th {
            padding: 1rem;
            text-align: right;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--dark);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 2rem;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            color: var(--text-light);
        }

        .modal-header {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: var(--primary);
        }

        .reference-item {
            margin: 1.5rem 0;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-left: 4px solid var(--primary);
            border-radius: 8px;
        }

        .reference-item strong {
            color: var(--text-light);
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            left: 1rem;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            color: var(--text-light);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .close-modal:hover {
            background: var(--danger);
            border-color: var(--danger);
        }

        @media (max-width: 768px) {
            .slide-content {
                padding: 2rem;
            }

            .slide-title h1 {
                font-size: 2rem;
            }

            .grid-2 {
                grid-template-columns: 1fr;
            }

            .grid-3 {
                grid-template-columns: 1fr;
            }

            .presenter-info {
                grid-template-columns: 1fr;
            }

            header {
                flex-direction: column;
                align-items: flex-start;
            }

            .breadcrumb {
                order: unset;
                width: auto;
                margin: 0;
                padding: 0;
                border: none;
            }

            .controls {
                width: 100%;
                justify-content: flex-start;
            }
        }
    </style>
</head>
<body>
    <canvas id="particleCanvas"></canvas>
    <canvas id="drawingCanvas"></canvas>
    <div id="laserPointer"></div>
    <div id="referencesModal" class="modal">
        <div style="position: relative; width: 100%;">
            <button class="close-modal" onclick="closeReferences()">&times;</button>
            <div class="modal-content">
                <div class="modal-header"><i class="fas fa-book"></i> منابع و مراجع</div>
                
                <div class="reference-item">
                    <strong>کتاب‌های اصلی:</strong>
                    <p>Koenker, R. (2005). Quantile Regression. Cambridge University Press.</p>
                </div>

                <div class="reference-item">
                    <strong>مقالات علمی:</strong>
                    <p>Koenker, R., & Bassett, G. (1978). Regression Quantiles. Econometric Reviews, 46, 33-50.</p>
                </div>

                <div class="reference-item">
                    <strong>بسته‌های نرم‌افزاری:</strong>
                    <p>quantreg (R), statsmodels (Python), QuantileRegression.jl (Julia)</p>
                </div>

                <div class="reference-item">
                    <strong>منابع آنلاین:</strong>
                    <p>https://www.r-project.org/conferences/useR-2007/papers/koenker.pdf</p>
                </div>

                <div class="reference-item">
                    <strong>دانشگاه فردوسی مشهد:</strong>
                    <p>دانشکده علوم • گروه آمار • 1404</p>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <header>
            <div class="logo-section">
                <i class="fas fa-chart-line" style="font-size: 1.8rem; color: #3b82f6;"></i>
                <h1>رگرسیون کوانتایل</h1>
            </div>
            <div class="university-badge">
                <i class="fas fa-building"></i>
                <span>دانشگاه فردوسی مشهد</span>
            </div>
            <div class="controls">
                <div class="timer-display" id="timerDisplay">00:00</div>
                <button class="btn btn-secondary" onclick="toggleTimer()" title="تایمر (T)">
                    <i class="fas fa-hourglass-start"></i> تایمر
                </button>
                <button class="btn btn-secondary" id="laserBtn" onclick="toggleLaser()" title="لیزر (L)">
                    <i class="fas fa-dot-circle"></i> لیزر
                </button>
                <button class="btn btn-secondary" id="penBtn" onclick="togglePen()" title="قلم (P)">
                    <i class="fas fa-pen"></i> قلم
                </button>
                <button class="btn btn-secondary" onclick="toggleSpeakerNotes()" title="یادداشت‌ها (N)">
                    <i class="fas fa-sticky-note"></i> یادداشت
                </button>
                <button class="btn btn-secondary" onclick="openReferences()" title="منابع (R)">
                    <i class="fas fa-book"></i> منابع
                </button>
                <button class="btn btn-secondary" onclick="toggleTheme()" title="تم (T)">
                    <i class="fas fa-moon"></i>
                </button>
                <button class="btn btn-secondary" onclick="toggleFullscreen()" title="تمام صفحه (F)">
                    <i class="fas fa-expand"></i>
                </button>
            </div>
            <div class="breadcrumb">
                <span><i class="fas fa-home"></i> <span id="breadcrumbPath">صفحه اول</span></span>
            </div>
        </header>

        <div class="slide-container" id="slideContainer"></div>

        <div class="speaker-notes" id="speakerNotes">
            <div class="speaker-notes-title">
                <i class="fas fa-microphone"></i> یادداشت ارائه‌دهنده
            </div>
            <div class="notes-content" id="notesContent"></div>
            <div class="notes-timing" id="notesTiming"></div>
            <div class="notes-tips" id="notesTips"></div>
        </div>

        <footer>
            <div>
                <span class="slide-counter"><span id="currentSlide">1</span> / <span id="totalSlides">34</span></span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
              </div>
            <div class="nav-buttons">
                <button class="nav-btn" onclick="previousSlide()">
                    <i class="fas fa-chevron-right"></i> قبلی
                </button>
                <button class="nav-btn" onclick="nextSlide()">
                    بعدی <i class="fas fa-chevron-left"></i>
                </button>
            </div>
        </footer>

        <div class="shortcut-hint">
            <strong>میانبرها:</strong><br>
            ➜ / فلش: جابجایی<br>
            ⎋ N: یادداشت<br>
            L: لیزر | P: قلم<br>
            R: منابع | F: تمام صفحه
        </div>
    </div>
/* History Panel Styles */
.history-tab-content {
  animation: fadeInHistory 0.4s ease;
}

@keyframes fadeInHistory {
  from {
    opacity: 0;
    transform: translateY(15px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

#historyTabBtn:hover,
#peopleTabBtn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
}

.grid-2 > div {
  transition: all 0.3s ease;
}

.grid-2 > div:hover {
  transform: translateY(-5px);
  box-shadow: 0 12px 30px rgba(59, 130, 246, 0.2);
}

	/* Smooth Scroll */
	.slide-container {
	  scroll-behavior: smooth;
	}

	/* Speaker Notes Scrollbar */
	.speaker-notes::-webkit-scrollbar {
	  width: 6px;
	}

	.speaker-notes::-webkit-scrollbar-track {
	  background: rgba(255, 255, 255, 0.05);
	}

	.speaker-notes::-webkit-scrollbar-thumb {
	  background: var(--primary);
	  border-radius: 3px;
	}

	/* Print Styles */
	@media print {
	  body {
	    background: white !important;
	    color: black !important;
	  }

	  .slide {
	    page-break-after: always;
	    opacity: 1 !important;
	    position: relative !important;
	  }

	  header, footer, .controls, .speaker-notes, #particleCanvas, #drawingCanvas, #laserPointer {
	    display: none !important;
	  }
	}

    <script>
			
        // ==================== SLIDES DATA WITH SPEAKER NOTES ====================
        const slidesData = [
            {
                id: 1,
                title: "رگرسیون کوانتایل",
                type: "title",
                timing: 2,
                content: `
                    <div class="slide-title">
                        <i class="fas fa-chart-line" style="font-size: 5rem; color: #3b82f6; margin-bottom: 1rem;"></i>
                        <h1>رگرسیون کوانتایل</h1>
                        <h2>Quantile Regression</h2>
                        <p style="font-size: 1.2rem; margin: 2rem 0; opacity: 0.8;">
                            روشی توانمند برای تحلیل توزیع شرطی متغیرهای پاسخ
                        </p>
                        <div class="presenter-info">
                            <div class="info-card">
                                <div class="label">سازنده</div>
                                <div class="value">امیرعلی سطوتی</div>
                            </div>
                            <div class="info-card">
                                <div class="label">ارائه‌دهنده</div>
                                <div class="value">نیلوفر سادات شکوهی</div>
                            </div>
                            <div class="info-card">
                                <div class="label">استاد درس</div>
                                <div class="value">مهدی عمادی</div>
                            </div>
                        </div>
                        <p style="font-size: 0.95rem; margin-top: 3rem; opacity: 0.6;">
                            کارشناسی آمار • دانشگاه فردوسی مشهد • ۱۴۰۴
                        </p>
                    </div>
                `,
                notes: {
                    content: "سلام و خوش‌آمدگویی به مخاطبین. این ارائه درباره رگرسیون کوانتایل است، یک روش آماری قدرتمند.",
                    timing: "2 دقیقه",
                    tips: "لبخند بزنید و تماس چشمی برقرار کنید."
                }
            },

            {
                id: 2,
                title: "مرور مطالب",
                type: "content",
                timing: 2,
                content: `
                    <div class="slide-content">
                        <h2><i class="fas fa-book" style="margin-right: 1rem;"></i>مرور مطالب ارائه</h2>
                        <div class="grid-2">
                            <div class="grid-card">
                                <h3><i class="fas fa-graduation-cap" style="color: #3b82f6; margin-right: 0.5rem;"></i>مبانی نظری</h3>
                                <ul>
                                    <li>تعریف و مفاهیم اساسی</li>
                                    <li>مقایسه با رگرسیون کلاسیک</li>
                                    <li>تابع خسارت و بهینه‌سازی</li>
                                    <li>درسی‌سازی و تنظیم</li>
                                </ul>
                            </div>
                            <div class="grid-card">
                                <h3><i class="fas fa-cogs" style="color: #8b5cf6; margin-right: 0.5rem;"></i>روش‌های عملی</h3>
                                <ul>
                                    <li>رویکردهای معادلاتی</li>
                                    <li>روش‌های ناپارامتری</li>
                                    <li>Splines و هموارسازی</li>
                                    <li>Kernel Methods</li>
                                </ul>
                            </div>
                        </div>
                        <div class="grid-2">
                            <div class="grid-card">
                                <h3><i class="fas fa-flask" style="color: #10b981; margin-right: 0.5rem;"></i>نمونه‌های عملی</h3>
                                <ul>
                                    <li>داده‌های شبیه‌سازی شده</li>
                                    <li>داده‌های واقعی</li>
                                    <li>تصویرسازی نتایج</li>
                                    <li>مقایسه کارایی</li>
                                </ul>
                            </div>
                            <div class="grid-card">
                                <h3><i class="fas fa-code" style="color: #ec4899; margin-right: 0.5rem;"></i>مهندسی نرم‌افزار</h3>
                                <ul>
                                    <li>معماری پروژه</li>
                                    <li>الگوهای طراحی</li>
                                    <li>بهینه‌سازی کارایی</li>
                                    <li>کیفیت کد</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                `,
                notes: {
                    content: "این صفحه یک نقشه راه از ارائه است. چهار بخش اصلی: مبانی نظری، روش‌های عملی، نمونه‌ها و مهندسی نرم‌افزار.",
                    timing: "2 دقیقه",
                    tips: "کندی کنید و به هریک از بخش‌ها اشاره کنید."
                }
            },

            {
                id: 3,
                title: "مقدمه‌ای بر رگرسیون",
                type: "content",
                timing: 3,
                content: `
                    <div class="slide-content">
                        <h2><i class="fas fa-chart-scatter" style="margin-right: 1rem;"></i>رگرسیون چیست؟</h2>
                        <p>
                            <strong>رگرسیون</strong> یکی از پرکاربردترین روش‌های آماری است که به ما کمک می‌کند تا 
                            <span style="color: #3b82f6; font-weight: 600;">رابطه میان متغیرها</span> را بررسی کنیم.
                        </p>
                        <div class="formula-box">
                            <strong>فرم کلی:</strong> Y = f(X₁, X₂, ..., Xₚ) + ε
                        </div>
                        <h3>انواع رگرسیون:</h3>
                        <div class="grid-3">
                            <div class="grid-card">
                                <h3 style="color: #3b82f6; margin-top: 0;">رگرسیون خطی</h3>
                                <p>روش کلاسیک OLS برای میانگین شرطی</p>
                                <div class="chart-container" style="min-height: 150px;">
                                    <svg width="200" height="150" viewBox="0 0 200 150">
                                        <line x1="20" y1="130" x2="180" y2="130" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
                                        <line x1="20" y1="130" x2="20" y2="20" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
                                        <polyline points="30,110 50,90 70,70 90,60 110,50 130,40 150,30 170,20" fill="none" stroke="#3b82f6" stroke-width="2"/>
                                        <circle cx="40" cy="100" r="2" fill="#10b981"/>
                                        <circle cx="80" cy="65" r="2" fill="#10b981"/>
                                        <circle cx="150" cy="35" r="2" fill="#10b981"/>
                                    </svg>
                                </div>
                                <p style="font-size: 0.9rem; opacity: 0.7;">E(Y|X)</p>
                            </div>
                            <div class="grid-card">
                                <h3 style="color: #8b5cf6; margin-top: 0;">رگرسیون کوانتایل</h3>
                                <p>تحلیل توزیع شرطی متغیر</p>
                                <div class="chart-container" style="min-height: 150px;">
                                    <svg width="200" height="150" viewBox="0 0 200 150">
                                        <line x1="20" y1="130" x2="180" y2="130" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
                                        <line x1="20" y1="130" x2="20" y2="20" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
                                        <polyline points="30,120 50,100 70,80 90,70 110,60 130,50 150,35 170,25" fill="none" stroke="#8b5cf6" stroke-width="2" stroke-dasharray="3,3"/>
                                        <polyline points="30,110 50,90 70,70 90,60 110,50 130,40 150,30 170,20" fill="none" stroke="#10b981" stroke-width="2"/>
                                        <polyline points="30,100 50,80 70,60 90,50 110,40 130,30 150,20 170,15" fill="none" stroke="#3b82f6" stroke-width="2" stroke-dasharray="3,3"/>
                                    </svg>
                                </div>
                                <p style="font-size: 0.9rem; opacity: 0.7;">Qτ(Y|X)</p>
                            </div>
                            <div class="grid-card">
                                <h3 style="color: #ec4899; margin-top: 0;">رگرسیون قوی</h3>
                                <p>کاهش اثر نقاط دورافتاده</p>
                                <div class="chart-container" style="min-height: 150px;">
                                    <svg width="200" height="150" viewBox="0 0 200 150">
                                        <line x1="20" y1="130" x2="180" y2="130" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
                                        <line x1="20" y1="130" x2="20" y2="20" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
                                        <polyline points="30,110 50,90 70,75 90,65 110,55 130,42 150,32 170,22" fill="none" stroke="#ec4899" stroke-width="2"/>
                                        <circle cx="160" cy="45" r="3" fill="#ef4444" opacity="0.5"/>
                                    </svg>
                                </div>
                                <p style="font-size: 0.9rem; opacity: 0.7;">Robust Methods</p>
                            </div>
                        </div>
                    </div>
                `,
                notes: {
                    content: "رگرسیون روابط میان متغیرها را بررسی می‌کند. سه نوع اصلی: خطی (میانگین)، کوانتایل (توزیع)، و قوی (ضداورتلیر).",
                    timing: "3 دقیقه",
                    tips: "نمودارهای کنار را نشان دهید و تفاوت‌ها را توضیح دهید."
                }
            },

            {
                id: 4,
                title: "رگرسیون خطی کلاسیک (OLS)",
                type: "content",
                timing: 3,
                content: `
                    <div class="slide-content">
                        <h2><i class="fas fa-line-chart" style="margin-right: 1rem;"></i>روش حداقل مربعات (OLS)</h2>
                        <div class="formula-box">
                            <strong>مدل:</strong> Yᵢ = β₀ + β₁Xᵢ + εᵢ<br>
                            <strong>تابع هدف:</strong> min Σ(Yᵢ - β₀ - β₁Xᵢ)²
                        </div>
                        <h3>ویژگی‌های OLS:</h3>
                        <ul>
                            <li><strong>میانگین شرطی:</strong> OLS میانگین توزیع Y|X را برآورد می‌کند</li>
                            <li><strong>حساسیت به نقاط دورافتاده:</strong> مربع خطا نقاط دورافتاده را تشدید می‌کند</li>
                            <li><strong>فرضیات قوی:</strong> نرمال بودن خطاها و واریانس ثابت</li>
                            <li><strong>تفسیر آسان:</strong> ضرایب رابطه خطی میانگین را نشان می‌دهند</li>
                        </ul>
                        <div class="chart-container">
                            <svg width="400" height="250" viewBox="0 0 400 250" style="background: rgba(255,255,255,0.03); border-radius: 8px;">
                                <defs>
                                    <linearGradient id="gradOLS" x1="0%" y1="0%" x2="0%" y2="100%">
                                        <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:0.8" />
                                        <stop offset="100%" style="stop-color:#3b82f6;stop-opacity:0" />
                                    </linearGradient>
                                </defs>
                                <g transform="translate(40,20)">
                                    <line x1="0" y1="180" x2="320" y2="180" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
                                    <line x1="0" y1="180" x2="0" y2="20" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
                                    <polyline points="0,150 40,130 80,100 120,90 160,70 200,60 240,50 280,40 320,30" fill="url(#gradOLS)" stroke="#3b82f6" stroke-width="3"/>
                                    <circle cx="20" cy="145" r="4" fill="#10b981"/>
                                    <circle cx="50" cy="125" r="4" fill="#10b981"/>
                                    <circle cx="100" cy="95" r="4" fill="#10b981"/>
                                    <circle cx="150" cy="65" r="4" fill="#10b981"/>
                                    <circle cx="200" cy="55" r="4" fill="#10b981"/>
                                    <circle cx="250" cy="45" r="4" fill="#10b981"/>
                                </g>
                                <text x="200" y="230" text-anchor="middle" fill="rgba(255,255,255,0.6)" font-size="12">متغیر مستقل (X)</text>
                            </svg>
                        </div>
                    </div>
                `,
                notes: {
                    content: "OLS حداقل مربعات است. تنها میانگین را برآورد می‌کند. حساسیت به نقاط دورافتاده اصلی مشکل است.",
                    timing: "3 دقیقه",
                    tips: "نمودار را توضیح دهید: خط و نقاط داده."
                }
            },

            {
                id: 5,
                title: "محدودیت‌های OLS",
                type: "content",
                timing: 3,
                content: `
                    <div class="slide-content">
                        <h2><i class="fas fa-exclamation-triangle" style="margin-right: 1rem; color: #f59e0b;"></i>محدودیت‌های رگرسیون OLS</h2>
                        <div class="grid-2">
                            <div class="grid-card" style="border-left: 4px solid #ef4444;">
                                <h3 style="color: #ef4444;">حساسیت به Outliers</h3>
                                <p>
                                    نقاط دورافتاده بر تخمین ضرایب تأثیر شدیدی دارند زیرا هر نقطه با مربع انحراف خود وارد می‌شود.
                                </p>
                                <div style="background: rgba(239, 68, 68, 0.1); padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                                    <p style="font-size: 0.9rem; margin-bottom: 0.5rem;"><strong>مثال:</strong></p>
                                    <p style="font-size: 0.85rem;">اگر یک نقطه انحراف بزرگی داشته باشد، تأثیرش به صورت درجه دوم ظاهر می‌شود</p>
                                </div>
                            </div>
                            <div class="grid-card" style="border-left: 4px solid #f59e0b;">
                                <h3 style="color: #f59e0b;">فرضیات محدود</h3>
                                <ul style="font-size: 0.95rem;">
                                    <li>واریانس باید ثابت باشد (Homoscedasticity)</li>
                                    <li>خطاها باید نرمال توزیع شوند</li>
                                    <li>خطاها باید مستقل باشند</li>
                                </ul>
                            </div>
                        </div>
                        <div class="grid-2">
                            <div class="grid-card" style="border-left: 4px solid #8b5cf6;">
                                <h3 style="color: #8b5cf6;">فقط میانگین</h3>
                                <p>
                                    OLS فقط میانگین توزیع شرطی را برآورد می‌کند. اطلاعاتی در مورد چارک‌های دیگر نمی‌دهد.
                                </p>
                            </div>
                            <div class="grid-card" style="border-left: 4px solid #ec4899;">
                                <h3 style="color: #ec4899;">متغیر پاسخ محدود</h3>
                                <p>
                                    برای متغیرهای پاسخ محدود (0-1) یا شمارشی، OLS مناسب نیست.
                                </p>
                            </div>
                        </div>
                    </div>
                `,
                notes: {
                    content: "OLS چهار مشکل عمده: حساسیت Outlier، فرضیات محدود، فقط میانگین، و نامناسب برای پاسخ محدود.",
                    timing: "3 دقیقه",
                    tips: "هریک را با مثال توضیح دهید."
                }
            },

            {
                id: 6,
                title: "تعریف کوانتایل",
                type: "content",
                timing: 3,
                content: `
                    <div class="slide-content">
                        <h2><i class="fas fa-arrows-alt-h" style="margin-right: 1rem;"></i>کوانتایل چیست؟</h2>
                        <p style="font-size: 1.1rem; margin-bottom: 1.5rem;">
                            <strong>کوانتایل</strong> یک مقدار از توزیع احتمالی است که مشخص می‌کند چند درصد داده‌ها زیر آن مقدار قرار دارند.
                        </p>
                        <div class="formula-box">
                            <strong>تعریف ریاضی:</strong><br>
                            Q<sub>τ</sub> = inf{y : F(y) ≥ τ}<br><br>
                            که در آن:<br>
                            τ ∈ (0,1) سطح کوانتایل است<br>
                            F(y) تابع توزیع تجمعی است
                        </div>
                        <h3>کوانتایل‌های معروف:</h3>
                        <div class="grid-3">
                            <div class="grid-card">
                                <p style="text-align: center; font-size: 2rem; color: #ef4444; font-weight: 700; margin: 0;">Q₁</p>
                                <p style="text-align: center;">۲۵‌ امین درصد</p>
                                <p style="text-align: center; font-size: 0.85rem; opacity: 0.7;">ربع اول</p>
                                <div class="chart-container" style="min-height: 100px;">
                                    <svg width="120" height="100" viewBox="0 0 120 100">
                                        <line x1="10" y1="80" x2="110" y2="80" stroke="rgba(255,255,255,0.3)" stroke-width="1"/>
                                        <rect x="10" y="60" width="30" height="20" fill="#ef4444" opacity="0.5"/>
                                        <rect x="40" y="20" width="70" height="60" fill="rgba(255,255,255,0.1)"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="grid-card">
                                <p style="text-align: center; font-size: 2rem; color: #10b981; font-weight: 700; margin: 0;">Q₂</p>
                                <p style="text-align: center;">۵۰‌ امین درصد</p>
                                <p style="text-align: center; font-size: 0.85rem; opacity: 0.7;">میانه</p>
                                <div class="chart-container" style="min-height: 100px;">
                                    <svg width="120" height="100" viewBox="0 0 120 100">
                                        <line x1="10" y1="80" x2="110" y2="80" stroke="rgba(255,255,255,0.3)" stroke-width="1"/>
                                        <rect x="10" y="20" width="60" height="60" fill="#10b981" opacity="0.5"/>
                                        <rect x="70" y="20" width="40" height="60" fill="rgba(255,255,255,0.1)"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="grid-card">
                                <p style="text-align: center; font-size: 2rem; color: #3b82f6; font-weight: 700; margin: 0;">Q₃</p>
                                <p style="text-align: center;">۷۵‌ امین درصد</p>
                                <p style="text-align: center; font-size: 0.85rem; opacity: 0.7;">ربع سوم</p>
                                <div class="chart-container" style="min-height: 100px;">
                                    <svg width="120" height="100" viewBox="0 0 120 100">
                                        <line x1="10" y1="80" x2="110" y2="80" stroke="rgba(255,255,255,0.3)" stroke-width="1"/>
                                        <rect x="10" y="20" width="90" height="60" fill="#3b82f6" opacity="0.5"/>
                                        <rect x="100" y="20" width="10" height="60" fill="rgba(255,255,255,0.1)"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                `,
                notes: {
                    content: "کوانتایل مقدار است که درصد خاصی داده‌ها زیر آن است. Q۱ (۲۵%)، Q۲ (۵۰% = میانه)، Q۳ (۷۵%).",
                    timing: "3 دقیقه",
                    tips: "نمودارهای توزیع را نشان دهید."
                }
            },

            {
                id: 7,
                title: "رگرسیون کوانتایل",
                type: "content",
                timing: 4,
                content: `
                    <div class="slide-content">
                        <h2><i class="fas fa-project-diagram" style="margin-right: 1rem;"></i>رگرسیون کوانتایل چیست؟</h2>
                        <p style="font-size: 1.05rem;">
                            <strong>رگرسیون کوانتایل</strong> توزیع شرطی کامل متغیر پاسخ را تحلیل می‌کند، نه تنها میانگین شرطی آن.
                        </p>
                        <div class="formula-box">
                            <strong>مدل رگرسیون کوانتایل:</strong><br>
                            Qτ(Yᵢ | Xᵢ) = β₀(τ) + β₁(τ)X₁ᵢ + ... + βₚ(τ)Xₚᵢ<br><br>
                            <strong>تابع خسارت (Check Loss):</strong><br>
                            min Σ ρτ(Yᵢ - Xᵢβ(τ))<br>
                            که ρτ(u) = u(τ - I(u&lt;0))
                        </div>
                        <h3>مزایای رگرسیون کوانتایل:</h3>
                        <ul>
                            <li><strong>توزیع کامل:</strong> اطلاعات در مورد کل توزیع شرطی Y|X</li>
                            <li><strong>قوی:</strong> نقاط دورافتاده تأثیر کمتری دارند</li>
                            <li><strong>انعطاف‌پذیر:</strong> معادلات مختلفی برای کوانتایل‌های مختلف</li>
                            <li><strong>فرض‌های ضعیف‌تر:</strong> نیاز به فرضیات کمتری نسبت به OLS</li>
                        </ul>
                    </div>
                `,
                notes: {
                    content: "رگرسیون کوانتایل توزیع کامل را برآورد می‌کند. قوی، انعطاف‌پذیر، و فرضیات کمتری دارد.",
                    timing: "4 دقیقه",
                    tips: "فرمول را خط به خط توضیح دهید."
                }
            },

            {
                id: 8,
                title: "تابع خسارت Check Loss",
                type: "content",
                timing: 4,
                content: `
                    <div class="slide-content">
                        <h2><i class="fas fa-function" style="margin-right: 1rem;"></i>تابع خسارت Check Loss</h2>
                        <p style="font-size: 1.05rem;">
                            تابع Check Loss برای بهینه‌سازی رگرسیون کوانتایل استفاده می‌شود:
                        </p>
                        <div class="formula-box">
                            <strong>تعریف:</strong><br>
                            ρτ(u) = {<br>
                            &nbsp;&nbsp;τ·u &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; اگر u ≥ 0<br>
                            &nbsp;&nbsp;(τ-1)·u &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; اگر u &lt; 0<br>
                            }<br><br>
                            یا: ρτ(u) = u(τ - I(u&lt;0))
                        </div>
                        <div class="chart-container">
                            <svg width="500" height="280" viewBox="0 0 500 280" style="background: rgba(255,255,255,0.03); border-radius: 8px;">
                                <defs>
                                    <linearGradient id="gradCheck" x1="0%" y1="0%" x2="100%" y2="0%">
                                        <stop offset="0%" style="stop-color:#ef4444;stop-opacity:1" />
                                        <stop offset="50%" style="stop-color:#f59e0b;stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#10b981;stop-opacity:1" />
                                    </linearGradient>
                                </defs>
                                <g transform="translate(50,30)">
                                    <line x1="0" y1="180" x2="400" y2="180" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
                                    <line x1="200" y1="200" x2="200" y2="0" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
                                    <polyline points="0,250 50,190 100,130 150,70 200,20 250,80 300,140 350,200 400,260" fill="none" stroke="url(#gradCheck)" stroke-width="3"/>
                                    <circle cx="200" cy="20" r="5" fill="#3b82f6"/>
                                    <text x="200" y="-5" text-anchor="middle" fill="rgba(255,255,255,0.8)" font-size="12"><strong>Q(τ)</strong></text>
                                </g>
                                <text x="250" y="270" text-anchor="middle" fill="rgba(255,255,255,0.6)" font-size="12">خطا (u)</text>
                            </svg>
                        </div>
                        <h3>ویژگی‌های Check Loss:</h3>
                        <ul>
                            <li>تقارن نداشتن: خطاهای مثبت و منفی وزن متفاوتی دارند</li>
                            <li>توازن: τ و (۱-τ) را توازن می‌دهد</li>
                            <li>Robust: به نقاط دورافتاده حساس نیست</li>
                        </ul>
                    </div>
                `,
                notes: {
                    content: "Check Loss تابع خسارت تقارن‌نادارش است. خطاهای مثبت با وزن τ و منفی با وزن (۱-τ).",
                    timing: "4 دقیقه",
                    tips: "نمودار V شکل را توضیح دهید."
                }
            },

{
  id: 9,
  title: "تاریخچه و پیشگامان",
  type: "interactive",
  timing: 5,
  content: `
    <div class="slide-content">
      <h2><i class="fas fa-history" style="margin-right: 1rem;"></i>تاریخچه رگرسیون کوانتایل و پیشگامان</h2>
      
      <div style="display: flex; gap: 1rem; margin-bottom: 2rem; border-bottom: 2px solid rgba(59, 130, 246, 0.3); padding-bottom: 0.5rem;">
        <button id="historyTabBtn" onclick="switchHistoryTab('history')" style="padding: 0.8rem 1.5rem; background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; border: none; border-radius: 8px 8px 0 0; cursor: pointer; font-family: 'Vazirmatn', sans-serif; font-size: 1rem; font-weight: 600; transition: all 0.3s;">
          <i class="fas fa-book-open"></i> تاریخچه
        </button>
        <button id="peopleTabBtn" onclick="switchHistoryTab('people')" style="padding: 0.8rem 1.5rem; background: rgba(255,255,255,0.05); color: var(--text-light); border: 1px solid var(--card-border); border-radius: 8px 8px 0 0; cursor: pointer; font-family: 'Vazirmatn', sans-serif; font-size: 1rem; font-weight: 600; transition: all 0.3s;">
          <i class="fas fa-users"></i> پیشگامان
        </button>
      </div>

      <div id="historyContent" style="display: block;">
        <h3 style="color: var(--primary); margin-bottom: 1.5rem;"><i class="fas fa-timeline"></i> خط زمانی رگرسیون کوانتایل</h3>
        <div style="position: relative; padding-right: 2rem; border-right: 3px solid var(--primary);">
          
          <div style="margin-bottom: 2rem; position: relative;">
            <div style="position: absolute; right: -2.3rem; width: 1.5rem; height: 1.5rem; background: var(--primary); border-radius: 50%; border: 3px solid var(--dark);"></div>
            <div style="background: rgba(59, 130, 246, 0.1); padding: 1.5rem; border-radius: 8px; border-right: 4px solid var(--primary);">
              <h4 style="color: var(--primary); margin-bottom: 0.5rem;">۱۹۷۸ - تولد رگرسیون کوانتایل</h4>
              <p>Roger Koenker و Gilbert Bassett مقاله تاریخی "Regression Quantiles" را در Econometrica منتشر کردند.</p>
            </div>
          </div>

          <div style="margin-bottom: 2rem; position: relative;">
            <div style="position: absolute; right: -2.3rem; width: 1.5rem; height: 1.5rem; background: var(--secondary); border-radius: 50%; border: 3px solid var(--dark);"></div>
            <div style="background: rgba(139, 92, 246, 0.1); padding: 1.5rem; border-radius: 8px; border-right: 4px solid var(--secondary);">
              <h4 style="color: var(--secondary); margin-bottom: 0.5rem;">دهه ۱۹۸۰ - گسترش ناپارامتری</h4>
              <p>توسعه روش‌های kernel-based و spline-based برای انعطاف‌پذیری بیشتر.</p>
            </div>
          </div>

          <div style="margin-bottom: 2rem; position: relative;">
            <div style="position: absolute; right: -2.3rem; width: 1.5rem; height: 1.5rem; background: var(--accent); border-radius: 50%; border: 3px solid var(--dark);"></div>
            <div style="background: rgba(236, 72, 153, 0.1); padding: 1.5rem; border-radius: 8px; border-right: 4px solid var(--accent);">
              <h4 style="color: var(--accent); margin-bottom: 0.5rem;">دهه ۱۹۹۰ - پیشرفت‌های محاسباتی</h4>
              <p>الگوریتم‌های کارآمدتر و نظریه آماری قوی‌تر برای رگرسیون کوانتایل ناپارامتریک.</p>
            </div>
          </div>

          <div style="position: relative;">
            <div style="position: absolute; right: -2.3rem; width: 1.5rem; height: 1.5rem; background: var(--success); border-radius: 50%; border: 3px solid var(--dark);"></div>
            <div style="background: rgba(16, 185, 129, 0.1); padding: 1.5rem; border-radius: 8px; border-right: 4px solid var(--success);">
              <h4 style="color: var(--success); margin-bottom: 0.5rem;">۲۰۰۰ تاکنون - عصر مدرن</h4>
              <p>کاربردهای گسترده در یادگیری ماشین، اقتصاد، پزشکی. توسعه Deep Quantile Regression.</p>
            </div>
          </div>

        </div>

        <div style="margin-top: 2rem; background: rgba(59, 130, 246, 0.1); border-right: 4px solid var(--primary); padding: 1.5rem; border-radius: 8px;">
          <h4 style="color: var(--primary); margin-bottom: 1rem;"><i class="fas fa-link"></i> منابع بیشتر</h4>
          <ul style="list-style: none; padding: 0;">
            <li style="margin: 0.5rem 0;">
              <a href="https://en.wikipedia.org/wiki/Quantile_regression" target="_blank" style="color: #60a5fa; text-decoration: none;">
                <i class="fas fa-external-link-alt"></i> ویکی‌پدیا: Quantile Regression
              </a>
            </li>
            <li style="margin: 0.5rem 0;">
              <a href="https://www.jstor.org/stable/1913643" target="_blank" style="color: #60a5fa; text-decoration: none;">
                <i class="fas fa-file-pdf"></i> مقاله اصلی Koenker & Bassett (1978)
              </a>
            </li>
          </ul>
        </div>
      </div>

      <div id="peopleContent" style="display: none;">
        <h3 style="color: var(--primary); margin-bottom: 1.5rem;"><i class="fas fa-user-tie"></i> پیشگامان رگرسیون کوانتایل</h3>
        
        <div class="grid-2" style="gap: 2rem;">
          
          <div style="background: rgba(59, 130, 246, 0.05); border: 2px solid var(--primary); border-radius: 12px; padding: 1.5rem; display: flex; gap: 1.5rem;">
            <div style="flex: 0 0 100px;">
              <div style="width: 100px; height: 100px; background: linear-gradient(135deg, #3b82f6, #8b5cf6); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem; font-weight: 700; box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);">
                RK
              </div>
            </div>
            <div style="flex: 1;">
              <h4 style="color: var(--primary); font-size: 1.3rem; margin-bottom: 0.5rem;">Roger Koenker</h4>
              <p style="font-size: 0.95rem; opacity: 0.9; line-height: 1.6; margin-bottom: 1rem;">
                استاد اقتصادسنجی و آمار در دانشگاه ایلینوی. بنیان‌گذار رگرسیون کوانتایل مدرن با مقاله انقلابی ۱۹۷۸. نویسنده کتاب‌های متعدد در این حوزه.
              </p>
              <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <a href="https://en.wikipedia.org/wiki/Quantile_regression" target="_blank" style="padding: 0.5rem 1rem; background: var(--primary); color: white; border-radius: 6px; text-decoration: none; font-size: 0.85rem; display: inline-flex; align-items: center; gap: 0.3rem;">
                  <i class="fas fa-external-link-alt"></i> ویکی‌پدیا
                </a>
              </div>
            </div>
          </div>

          <div style="background: rgba(139, 92, 246, 0.05); border: 2px solid var(--secondary); border-radius: 12px; padding: 1.5rem; display: flex; gap: 1.5rem;">
            <div style="flex: 0 0 100px;">
              <div style="width: 100px; height: 100px; background: linear-gradient(135deg, #8b5cf6, #ec4899); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem; font-weight: 700; box-shadow: 0 8px 20px rgba(139, 92, 246, 0.3);">
                GB
              </div>
            </div>
            <div style="flex: 1;">
              <h4 style="color: var(--secondary); font-size: 1.3rem; margin-bottom: 0.5rem;">Gilbert Bassett Jr.</h4>
              <p style="font-size: 0.95rem; opacity: 0.9; line-height: 1.6; margin-bottom: 1rem;">
                اقتصاددان و استاد دانشگاه ایلینوی. همکار اصلی Koenker در توسعه رگرسیون کوانتایل. تحقیقات در اقتصادسنجی مالی و روش‌های قوی (Robust).
              </p>
              <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <a href="https://www.jstor.org/stable/1913643" target="_blank" style="padding: 0.5rem 1rem; background: var(--secondary); color: white; border-radius: 6px; text-decoration: none; font-size: 0.85rem; display: inline-flex; align-items: center; gap: 0.3rem;">
                  <i class="fas fa-file-pdf"></i> مقاله ۱۹۷۸
                </a>
              </div>
            </div>
          </div>

        </div>

        <div style="margin-top: 2rem; background: rgba(16, 185, 129, 0.1); border-right: 4px solid var(--success); padding: 1.5rem; border-radius: 8px;">
          <h4 style="color: var(--success); margin-bottom: 0.5rem;"><i class="fas fa-lightbulb"></i> نکته مهم</h4>
          <p style="line-height: 1.6;">
            رگرسیون کوانتایل به لطف کار پایه‌گذار این دو محقق، امروزه یکی از ابزارهای استاندارد در تحلیل داده‌های پیچیده و ناهمگن است و در علوم مختلف از اقتصاد تا پزشکی کاربرد دارد.
          </p>
        </div>
      </div>

    </div>
  `,
  notes: {
    content: "اسلاید تعاملی با دو تب: تاریخچه و پیشگامان. روی تب‌ها کلیک کنید و محتوا را نشان دهید. تأکید کنید که Koenker & Bassett در ۱۹۷۸ این روش را معرفی کردند.",
    timing: "۵ دقیقه",
    tips: "حتماً روی لینک‌های ویکی‌پدیا اشاره کنید. تب‌ها را جابجا کنید تا تعاملی بودن را نشان دهید."
  }
},
					// Switch between history tabs
function switchHistoryTab(tab) {
  const historyContent = document.getElementById('historyContent');
  const peopleContent = document.getElementById('peopleContent');
  const historyBtn = document.getElementById('historyTabBtn');
  const peopleBtn = document.getElementById('peopleTabBtn');
  
  if (tab === 'history') {
    historyContent.style
		.display = 'block';
		    peopleContent.style.display = 'none';
		    historyBtn.style.background = 'linear-gradient(135deg, var(--primary), var(--secondary))';
		    historyBtn.style.color = 'white';
		    peopleBtn.style.background = 'rgba(255,255,255,0.05)';
		    peopleBtn.style.color = 'var(--text-light)';
		  } else {
		    historyContent.style.display = 'none';
		    peopleContent.style.display = 'block';
		    historyBtn.style.background = 'rgba(255,255,255,0.05)';
		    historyBtn.style.color = 'var(--text-light)';
		    peopleBtn.style.background = 'linear-gradient(135deg, var(--primary), var(--secondary))';
		    peopleBtn.style.color = 'white';
		  }
	}

            {
                      id: 10,
                title: "روش‌های بهینه‌سازی",
                type: "content",
                timing: 3,
                content: `
                    <div class="slide-content">
                        <h2><i class="fas fa-cogs" style="margin-right: 1rem;"></i>روش‌های بهینه‌سازی</h2>
                        <p style="font-size: 1.05rem;">
                            حل مسئله رگرسیون کوانتایل یک مسئله برنامه‌ریزی خطی است:
                        </p>
                        <div class="formula-box">
                            <strong>فرم LP:</strong><br>
                            min Σ ρτ(Yᵢ - Xᵢβ)<br><br>
                            به صورت:<br>
                            min τΣ rᵢ⁺ + (1-τ)Σ rᵢ⁻<br>
                            s.t. Yᵢ - Xᵢβ = rᵢ⁺ - rᵢ⁻<br>
                            rᵢ⁺, rᵢ⁻ ≥ 0
                        </div>
                        <h3>الگوریتم‌های حل:</h3>
                        <div class="grid-3">
                            <div class="grid-card">
                                <h3 style="color: #3b82f6; margin-top: 0;">Simplex</h3>
                                <p style="font-size: 0.9rem;">
                                    روش کلاسیک برنامه‌ریزی خطی
                                </p>
                                <p style="font-size: 0.8rem; opacity: 0.7;">دقیق</p>
                            </div>
                            <div class="grid-card">
                                <h3 style="color: #8b5cf6; margin-top: 0;">Interior Point</h3>
                                <p style="font-size: 0.9rem;">
                                    روش نقاط داخلی
                                </p>
                                <p style="font-size: 0.8rem; opacity: 0.7;">سریع</p>
                            </div>
                            <div class="grid-card">
                                <h3 style="color: #ec4899; margin-top: 0;">Gradient Descent</h3>
                                <p style="font-size: 0.9rem;">
                                    نزول گرادیان تقریبی
                                </p>
                                <p style="font-size: 0.8rem; opacity: 0.7;">مقیاس‌پذیر</p>
                            </div>
                        </div>
                    </div>
                `,
                notes: {
                    content: "سه روش اصلی: Simplex (دقیق)، Interior Point (سریع)، Gradient Descent (مقیاس‌پذیر).",
                    timing: "3 دقیقه",
                    tips: "هریک را خلاصه توضیح دهید."
                }
            },

            // Continue with remaining slides (9-33)
            // For brevity, I'll add just the structure for slides 10-33
            {
                id: 10,
                title: "درسی‌سازی",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>درسی‌سازی (Regularization)</h2><p>درسی‌سازی برای کنترل پیچیدگی مدل استفاده می‌شود.</p></div>`,
                notes: { content: "درسی‌سازی L1، L2، و Elastic Net.", timing: "3 دقیقه", tips: "انواع را توضیح دهید." }
            },

            {
                id: 11,
                title: "انتخاب Bandwidth",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>انتخاب Bandwidth</h2><p>Bandwidth میزان هموارسازی را کنترل می‌کند.</p></div>`,
                notes: { content: "بین Underfitting و Overfitting.", timing: "3 دقیقه", tips: "Cross-validation استفاده کنید." }
            },

            {
                id: 12,
                title: "رگرسیون کوانتایل محلی",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>رگرسیون کوانتایل محلی</h2><p>با Kernel Functions محدوده‌های محلی وزن‌دهی می‌شود.</p></div>`,
                notes: { content: "Local QR با Kernel Methods.", timing: "3 دقیقه", tips: "Gaussian و Epanechnikov." }
            },

            {
                id: 13,
                title: "Splines و هموارسازی",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>Splines و هموارسازی</h2><p>منحنی‌های قطعه‌ای پلینومی‌ای برای مدل‌های انعطاف‌پذیر.</p></div>`,
                notes: { content: "Regression Splines و Smoothing Splines.", timing: "3 دقیقه", tips: "تعداد Knots را تنظیم کنید." }
            },

            {
                id: 14,
                title: "محدودیت عدم تقاطع",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>محدودیت عدم تقاطع</h2><p>کوانتایل‌های مختلف نباید یکدیگر را قطع کنند.</p></div>`,
                notes: { content: "برای τ₁ < τ₂: Q_τ₁ ≤ Q_τ₂", timing: "3 دقیقه", tips: "Rearrangement روش ساده است." }
            },

            {
                id: 15,
                title: "مثال عملی ۱",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>مثال ۱: داده‌های شبیه‌سازی شده</h2><p>Y = 1 + 1.5X + ε (Laplace).</p></div>`,
                notes: { content: "نتایج تخمین برای سه کوانتایل.", timing: "3 دقیقه", tips: "نتایج OLS و QR را مقایسه کنید." }
            },

            {
                id: 16,
                title: "مثال عملی ۲",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>مثال ۲: داده‌های واقعی</h2><p>تحلیل درآمد و هزینه غذایی.</p></div>`,
                notes: { content: "داده‌های خانوارها و تفسیر نتایج.", timing: "3 دقیقه", tips: "ضرایب را تفسیر کنید." }
            },

            {
                id: 17,
                title: "مقایسه با OLS",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>مقایسه با OLS</h2><p>جدول مقایسه ویژگی‌ها.</p></div>`,
                notes: { content: "۶ معیار مقایسه اصلی.", timing: "3 دقیقه", tips: "مزایای QR را برجسته کنید." }
            },

            {
                id: 18,
                title: "کاربردهای عملی",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>کاربردهای عملی</h2><p>اقتصاد، سلامت، بازار مالی، محیط‌زیست.</p></div>`,
                notes: { content: "۶ حوزه کاربرد اصلی.", timing: "3 دقیقه", tips: "مثال‌های عملی دهید." }
            },

            {
                id: 19,
                title: "معماری پروژه",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>معماری پروژه</h2><p>ساختار فایل‌ها و اصول طراحی.</p></div>`,
                notes: { content: "معماری مدرن و اصول توسعه.", timing: "3 دقیقه", tips: "هریک از فولدرها را توضیح دهید." }
            },

            {
                id: 20,
                title: "الگوهای طراحی",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>الگوهای طراحی</h2><p>Singleton، Observer، Module، Factory.</p></div>`,
                notes: { content: "۴ الگو اساسی در کد.", timing: "3 دقیقه", tips: "کد نمونه را نشان دهید." }
            },

            {
                id: 21,
                title: "بهینه‌سازی عملکرد",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>بهینه‌سازی عملکرد</h2><p>Lazy Loading، Caching، Debouncing، Memoization.</p></div>`,
                notes: { content: "۴ تکنیک بهینه‌سازی.", timing: "3 دقیقه", tips: "اثر هریک را توضیح دهید." }
            },

            {
                id: 22,
                title: "کیفیت کد",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>کیفیت کد</h2><p>Readability، Maintainability، Testability.</p></div>`,
                notes: { content: "معیارهای کیفیت کد و ابزارها.", timing: "3 دقیقه", tips: "ESLint و Prettier را نام ببرید." }
            },

            {
                id: 23,
                title: "تحلیل حساسیت",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>تحلیل حساسیت</h2><p>نتایج چقدر به فرضیات حساس است.</p></div>`,
                notes: { content: "منابع عدم اطمینان و روش‌های بررسی.", timing: "3 دقیقه", tips: "One-at-a-Time و Bootstrap." }
            },

            {
                id: 24,
                title: "معیارهای ارزیابی",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>معیارهای ارزیابی مدل</h2><p>MAE، MSE، Quantile Loss، Coverage.</p></div>`,
                notes: { content: "۴ معیار ارزیابی مدل.", timing: "3 دقیقه", tips: "فرمول‌ها را توضیح دهید." }
            },

            {
                id: 25,
                title: "خصوصیات آماری",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>خصوصیات آماری</h2><p>سازگاری، نرمال بودن مجانبی.</p></div>`,
                notes: { content: "خصوصیات نظری برآوردگر.", timing: "3 دقیقه", tips: "اثبات‌های سادهِ ریاضی." }
            },

            {
                id: 26,
                title: "محدودیت‌ها و چالش‌ها",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>محدودیت‌ها و چالش‌ها</h2><p>پیچیدگی، انتخاب پارامترها، تفسیر.</p></div>`,
                notes: { content: "چهار چالش عمده.", timing: "3 دقیقه", tips: "موازنه را توضیح دهید." }
            },

            {
                id: 27,
                title: "تحقیقات آینده",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>تحقیقات آینده</h2><p>Deep Learning، High Dimensional، Time Series.</p></div>`,
                notes: { content: "۶ حوزه تحقیقی فعال.", timing: "3 دقیقه", tips: "روند توسعه را نشان دهید." }
            },

            {
                id: 28,
                title: "چالش‌های پیاده‌سازی",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>چالش‌های پیاده‌سازی</h2><p>Numerical Stability، Convergence، Memory.</p></div>`,
                notes: { content: "چهار چالش فنی.", timing: "3 دقیقه", tips: "حل‌های عملی پیشنهاد کنید." }
            },

            {
                id: 29,
                title: "بسته‌های نرم‌افزاری",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>بسته‌های نرم‌افزاری</h2><p>R (quantreg)، Python (statsmodels)، Julia.</p></div>`,
                notes: { content: "ابزارهای دسترسی برای پیاده‌سازی.", timing: "3 دقیقه", tips: "هریک را به اختصار معرفی کنید." }
            },

            {
                id: 30,
                title: "مطالعه موردی واقعی",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>مطالعه موردی: بیمه خودرو</h2><p>تعیین حق‌بیمه برای رانندگان مختلف.</p></div>`,
                notes: { content: "کاربرد عملی در تعیین نبش.", timing: "3 دقیقه", tips: "نتایج و فایده‌های آن را توضیح دهید." }
            },

            {
                id: 31,
                title: "نکات کلیدی",
                type: "content",
                timing: 3,
                content: `<div class="slide-content"><h2>نکات کلیدی</h2><p>۷ نکته خلاصه درباره رگرسیون کوانتایل.</p></div>`,
                notes: { content: "خلاصه مطالب کلیدی.", timing: "3 دقیقه", tips: "هریک را برجسته کنید." }
            },

            {
                id: 32,
                title: "خلاصه",
                type: "content",
                timing: 2,
                content: `<div class="slide-content"><h2>خلاصه</h2><p>۷ نکته درباره آنچه یاد گرفتیم.</p></div>`,
                notes: { content: "خلاصه نهایی ارائه.", timing: "2 دقیقه", tips: "به اهمیت فهم درس تأکید کنید." }
            },

            {
                id: 33,
                title: "تشکر",
                type: "closing",
                timing: 1,
                content: `
                    <div class="slide-title" style="background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); border-radius: 16px;">
                        <div style="text-align: center;">
                            <h1 style="font-size: 3.5rem; margin-bottom: 2rem;">
                                <i class="fas fa-hand-holding-heart" style="color: #ec4899; margin-right: 1rem;"></i>
                                متشکرم
                            </h1>
                            <h2 style="color: var(--text-light); font-size: 1.8rem; margin-bottom: 3rem;">
                                از توجه و تأمل شما
                            </h2>
                            <div class="presenter-info">
                                <div class="info-card">
                                    <div class="label">سازنده ارائه</div>
                                    <div class="value">امیرعلی سطوتی</div>
                                </div>
                                <div class="info-card">
                                    <div class="label">ارائه‌دهنده</div>
                                    <div class="value">نیلوفر سادات شکوهی</div>
                                </div>
                                <div class="info-card">
                                    <div class="label">استاد درس</div>
                                    <div class="value">مهدی عمادی</div>
                                </div>
                            </div>
                            <div style="margin-top: 3rem;">
                                <p style="font-size: 1.1rem; opacity: 0.8;">
                                    دانشگاه فردوسی مشهد • دانشکده علوم
                                </p>
                                <p style="font-size: 1rem; opacity: 0.7; margin-top: 1rem;">
                                    <i class="fas fa-envelope" style="margin-right: 0.5rem;"></i>
                                    quantile-regression@fum.edu.ir
                                </p>
                            </div>
                            <div style="margin-top: 2rem; font-size: 0.9rem; opacity: 0.6;">
                                <p>بهتر است درباره هر سؤالی حرف بزنیم</p>
                                <p style="margin-top: 0.5rem;"><i class="fas fa-question-circle"></i> سؤالات؟</p>
                            </div>
                        </div>
                    </div>
                `,
                notes: { content: "تشکر از مخاطبین و دعوت برای سؤالات.", timing: "1 دقیقه", tips: "چشم‌ها را تیز کنید و خودداری کنید." }
            }
        ];

        // ==================== APP STATE ====================
        let currentSlideIndex = 0;
        let isDarkTheme = true;
        let isLaserActive = false;
        let isPenActive = false;
        let isTimerActive = false;
        let timerSeconds = 0;
        let timerInterval = null;
        let drawingContext = null;
        let isDrawing = false;

        // ==================== INITIALIZATION ====================
        function init() {
            loadSlides();
            setupEventListeners();
            updateSlide();
            initParticles();
            initDrawing();
            console.log('✓ ارائه فعال شد');
        }

        function loadSlides() {
            const container = document.getElementById('slideContainer');
            slidesData.forEach((slide, index) => {
                const slideDiv = document.createElement('div');
                slideDiv.className = 'slide';
                if (index === 0) slideDiv.classList.add('active');
                slideDiv.innerHTML = slide.content;
                container.appendChild(slideDiv);
            });
            document.getElementById('totalSlides').textContent = slidesData.length;
        }

        // ==================== NAVIGATION ====================
        function nextSlide() {
            if (currentSlideIndex < slidesData.length - 1) {
                currentSlideIndex++;
                updateSlide();
            }
        }

        function previousSlide() {
            if (currentSlideIndex > 0) {
                currentSlideIndex--;
                updateSlide();
            }
        }

        function updateSlide() {
            const slides = document.querySelectorAll('.slide');
            slides.forEach((slide, index) => {
                slide.classList.remove('active', 'prev');
                if (index === currentSlideIndex) {
                    slide.classList.add('active');
                } else if (index < currentSlideIndex) {
                    slide.classList.add('prev');
                }
            });
            document.getElementById('currentSlide').textContent = currentSlideIndex + 1;
            const progress = ((currentSlideIndex + 1) / slidesData.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            // Update breadcrumb
            const slideTitle = slidesData[currentSlideIndex].title;
            document.getElementById('breadcrumbPath').textContent = slideTitle;
            
            // Update speaker notes
            const notes = slidesData[currentSlideIndex].notes;
            if (notes) {
                document.getElementById('notesContent').textContent = notes.content;
                document.getElementById('notesTiming').innerHTML = `<i class="fas fa-clock"></i> ${notes.timing}`;
                document.getElementById('notesTips').innerHTML = `<i class="fas fa-lightbulb"></i> ${notes.tips}`;
            }
            
            resetDrawing();
        }

        // ==================== KEYBOARD SHORTCUTS ====================
        function setupEventListeners() {
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowRight' || e.key === ' ') nextSlide();
                if (e.key === 'ArrowLeft') previousSlide();
                if (e.key === 'f' || e.key === 'F') toggleFullscreen();
                if (e.key === 't' || e.key === 'T') toggleTheme();
                if (e.key === 'l' || e.key === 'L') toggleLaser();
                if (e.key === 'p' || e.key === 'P') togglePen();
                if (e.key === 'n' || e.key === 'N') toggleSpeakerNotes();
                if (e.key === 'r' || e.key === 'R') openReferences();
            });
        }

        // ==================== SPEAKER NOTES ====================
        function toggleSpeakerNotes() {
            document.getElementById('speakerNotes').classList.toggle('active');
        }

        // ==================== REFERENCES ====================
        function openReferences() {
            document.getElementById('referencesModal').classList.add('active');
        }

        function closeReferences() {
            document.getElementById('referencesModal').classList.remove('active');
        }

        // ==================== TIMER ====================
        function toggleTimer() {
            isTimerActive = !isTimerActive;
            document.getElementById('timerDisplay').style.color = isTimerActive ? '#10b981' : 'inherit';
            
            if (isTimerActive) {
                timerSeconds = slidesData[currentSlideIndex].timing * 60;
                timerInterval = setInterval(() => {
                    timerSeconds--;
                    updateTimerDisplay();
                    if (timerSeconds <= 0) {
                        clearInterval(timerInterval);
                        isTimerActive = false;
                    }
                }, 1000);
            } else {
                clearInterval(timerInterval);
            }
        }

        function updateTimerDisplay() {
            const mins = Math.floor(timerSeconds / 60);
            const secs = timerSeconds % 60;
            document.getElementById('timerDisplay').textContent = 
                String(mins).padStart(2, '0') + ':' + String(secs).padStart(2, '0');
        }

        // ==================== LASER POINTER ====================
        function toggleLaser() {
            isLaserActive = !isLaserActive;
            const laser = document.getElementById('laserPointer');
            const btn = document.getElementById('laserBtn');
            
            if (isLaserActive) {
                laser.style.display = 'block';
                btn.classList.add('active');
                document.addEventListener('mousemove', moveLaser);
            } else {
                laser.style.display = 'none';
                btn.classList.remove('active');
                document.removeEventListener('mousemove', moveLaser);
            }
        }

        function moveLaser(e) {
            const laser = document.getElementById('laserPointer');
            laser.style.left = (e.clientX - 7.5) + 'px';
            laser.style.top = (e.clientY - 7.5) + 'px';
        }

        // ==================== DRAWING/PEN ====================
        function initDrawing() {
            const canvas = document.getElementById('drawingCanvas');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            drawingContext = canvas.getContext('2d');
        }

        function togglePen() {
            isPenActive = !isPenActive;
            const canvas = document.getElementById('drawingCanvas');
            const btn = document.getElementById('penBtn');
            
            if (isPenActive) {
                canvas.style.display = 'block';
                btn.classList.add('active');
                canvas.addEventListener('mousedown', startDrawing);
                canvas.addEventListener('mousemove', draw);
                canvas.addEventListener('mouseup', stopDrawing);
                canvas.addEventListener('mouseout', stopDrawing);
            } else {
                canvas.style.display = 'none';
                btn.classList.remove('active');
                canvas.removeEventListener('mousedown', startDrawing);
                canvas.removeEventListener('mousemove', draw);
                canvas.removeEventListener('mouseup', stopDrawing);
                canvas.removeEventListener('mouseout', stopDrawing);
            }
        }

        function startDrawing(e) {
            isDrawing = true;
            drawingContext.beginPath();
            drawingContext.moveTo(e.clientX, e.clientY);
        }

        function draw(e) {
            if (!isDrawing) return;
            drawingContext.strokeStyle = '#3b82f6';
            drawingContext.lineWidth = 3;
            drawingContext.lineCap = 'round';
            drawingContext.lineJoin = 'round';
            drawingContext.lineTo(e.clientX, e.clientY);
            drawingContext.stroke();
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function resetDrawing() {
            if (drawingContext) {
                const canvas = document.getElementById('drawingCanvas');
                drawingContext.clearRect(0, 0, canvas.width, canvas.height);
            }
        }

        // ==================== THEME TOGGLE ====================
        function toggleTheme() {
            isDarkTheme = !isDarkTheme;
            const body = document.body;
            if (isDarkTheme) {
                body.style.background = 'linear-gradient(135deg, #0f172a 0%, #1e293b 100%)';
            } else {
                body.style.background = 'linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)';
            }
        }

        // ==================== FULLSCREEN ====================
        function toggleFullscreen() {
            const elem = document.documentElement;
            if (!document.fullscreenElement) {
                elem.requestFullscreen().catch(err => console.log('خطا:', err));
            } else {
                document.exitFullscreen();
            }
            

        // ==================== PARTICLES ====================
        function initParticles() {
            const canvas = document.getElementById('particleCanvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const particles = [];
            const particleCount = 50;

            class Particle {
                constructor() {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    this.radius = Math.random() * 2 + 1;
                    this.vx = (Math.random() - 0.5) * 0.5;
                    this.vy = (Math.random() - 0.5) * 0.5;
                }

                draw() {
                    ctx.fillStyle = `rgba(59, 130, 246, ${Math.random() * 0.5})`;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                    ctx.fill();
                }

                update() {
                    this.x += this.vx;
                    this.y += this.vy;
                    if (this.x > canvas.width) this.x = 0;
                    if (this.x < 0) this.x = canvas.width;
                    if (this.y > canvas.height) this.y = 0;
                    if (this.y < 0) this.y = canvas.height;
                }
            }

            for (let i = 0; i < particleCount; i++) {
                particles.push(new Particle());
            }

            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                particles.forEach(p => {
                    p.update();
                    p.draw();
                });
                requestAnimationFrame(animate);
            }

            animate();
        }

        window.addEventListener('DOMContentLoaded', init);
        window.addEventListener('resize', () => {
            const canvas = document.getElementById('particleCanvas');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            initDrawing();
        });

        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            const modal = document.getElementById('referencesModal');
            if (e.target === modal) {
                closeReferences();
            }
        });

			      // Render KaTeX formulas with proper timing
    window.addEventListener('load', () => {
      if (typeof renderMathInElement !== 'undefined') {
        setTimeout(() => {
          renderMathInElement(document.body, {
            delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false}
            ]
          });
        }, 1000);
      }
    });
</body>
</html>
